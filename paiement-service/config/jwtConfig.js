const jwt = require('jsonwebtoken');
const logger = require('../utils/logger');

class JwtConfig {
  
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GÃ©nÃ©rer un token d'accÃ¨s â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  static generateAccessToken(user) {
    try {
      return jwt.sign(
        {
          userId: user._id,
          email: user.email,
          role: user.role,
        },
        process.env.JWT_SECRET,
        {
          expiresIn: process.env.JWT_EXPIRES_IN || '1h',
        }
      );
    } catch (error) {
      logger.error('ðŸ’¥ Erreur lors de la gÃ©nÃ©ration du token d\'accÃ¨s :', error);
      throw error;
    }
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ GÃ©nÃ©rer un token de rafraÃ®chissement â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  static generateRefreshToken(user) {
    try {
      return jwt.sign(
        {
          userId: user._id,
          email: user.email,
        },
        process.env.JWT_SECRET,
        {
          expiresIn: process.env.JWT_REFRESH_EXPIRES_IN || '7d',
        }
      );
    } catch (error) {
      logger.error('ðŸ’¥ Erreur lors de la gÃ©nÃ©ration du token de rafraÃ®chissement :', error);
      throw error;
    }
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ VÃ©rifier un token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  static verifyToken(token) {
    return jwt.verify(token, process.env.JWT_SECRET);
  }
}

module.exports = JwtConfig;